# X02: Vulnerability Scan

## Context
Phase: **RECON** (2 of 2)
Purpose: Deep-scan for specific vulnerability patterns

## Mindset

**Systematically probe every weakness.**

Using the attack surface from X01, now scan for specific vulnerability patterns. This is a checklist-driven audit looking for known problem patterns.

## Input Required
- Reconnaissance report from X01
- All source files
- Focus on high-value targets identified

## Prompt

```
TASK: Scan for specific vulnerability patterns in target codebase.

INPUT:
{reconnaissance_report_from_X01}
{source_files}

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: NULL/VOID HAZARDS
Can we cause null reference errors?
═══════════════════════════════════════════════════════════════

Scan for:
1. Detachable attributes used without attachment check
2. Functions that can return Void
3. Parameters not validated for attachment

FINDING: {location}
  Pattern: {what was found}
  Trigger: {how to cause null access}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: BOUNDARY VIOLATIONS
Can we cause out-of-bounds errors?
═══════════════════════════════════════════════════════════════

Scan for:
1. Array/list indexing without bounds check
2. Substring operations without length validation
3. Loop bounds depending on input

FINDING: {location}
  Pattern: {what was found}
  Trigger: {how to cause out-of-bounds}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: EMPTY INPUT HAZARDS
Can we cause failures with empty input?
═══════════════════════════════════════════════════════════════

Scan for:
1. Features assuming non-empty strings
2. Features assuming non-empty collections
3. Division or modulo without zero-check

FINDING: {location}
  Pattern: {what was found}
  Trigger: {empty input that breaks it}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: STATE CORRUPTION
Can we leave objects in invalid state?
═══════════════════════════════════════════════════════════════

Scan for:
1. Partial updates (A changed, B not updated)
2. Operations that can fail midway
3. State changes without validation

FINDING: {location}
  Pattern: {what was found}
  Trigger: {how to corrupt state}
  Invalid state: {what state becomes invalid}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: RESOURCE LEAKS
Can we cause resource exhaustion?
═══════════════════════════════════════════════════════════════

Scan for:
1. Resources acquired but not released on error path
2. Unbounded growth (lists that only grow)
3. Missing cleanup in rescue clauses

FINDING: {location}
  Pattern: {what was found}
  Trigger: {how to cause leak}
  Resource: {what leaks}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: TYPE CONFUSION
Can we cause type-related errors?
═══════════════════════════════════════════════════════════════

Scan for:
1. Unsafe casts (?)
2. Type assumptions in generic code
3. Covariance issues

FINDING: {location}
  Pattern: {what was found}
  Trigger: {how to cause type error}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: CONCURRENCY HAZARDS
Can we cause race conditions?
═══════════════════════════════════════════════════════════════

Scan for:
1. Shared mutable state
2. Check-then-act patterns
3. Non-atomic compound operations

FINDING: {location}
  Pattern: {what was found}
  Trigger: {timing that causes issue}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: INJECTION HAZARDS
Can we inject malicious input?
═══════════════════════════════════════════════════════════════

Scan for:
1. String concatenation used to build commands
2. User input passed to external systems
3. File paths from user input

FINDING: {location}
  Pattern: {what was found}
  Trigger: {malicious input example}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: LOGIC ERRORS
Can we exploit flawed logic?
═══════════════════════════════════════════════════════════════

Scan for:
1. Off-by-one errors
2. Incorrect boolean logic
3. Missing cases in inspect
4. Loop termination issues

FINDING: {location}
  Pattern: {what was found}
  Trigger: {input that exposes logic error}
  Severity: [CRITICAL | HIGH | MEDIUM | LOW]

═══════════════════════════════════════════════════════════════
VULNERABILITY PATTERN: CONTRACT GAPS
What should be protected but isn't?
═══════════════════════════════════════════════════════════════

For each feature without contracts:

GAP: {class}.{feature}
  Should have precondition: {what}
  Should have postcondition: {what}
  Risk if unprotected: {what can go wrong}

═══════════════════════════════════════════════════════════════
VULNERABILITY SUMMARY
Prioritized list of weaknesses
═══════════════════════════════════════════════════════════════

Rank all findings by:
1. CRITICAL: Immediate exploit possible
2. HIGH: Likely to cause failure in normal use
3. MEDIUM: Could cause failure with specific input
4. LOW: Theoretical issue, hard to trigger

OUTPUT FORMAT:

# VULNERABILITY SCAN REPORT: {library_name}

## Scan Summary
- Total vulnerabilities: {count}
- Critical: {count}
- High: {count}
- Medium: {count}
- Low: {count}

## Critical Findings
{Detailed list with exploit instructions}

## High Findings
{Detailed list}

## Medium Findings
{List}

## Low Findings
{List}

## Attack Plan
Based on vulnerabilities found, the attack plan for next phase:

1. **First assault**: {target} using {vulnerability}
2. **Second assault**: {target} using {vulnerability}
...

## Recommended Defenses (for later)
{List of contracts that would block these attacks}
```

## Success Criteria
- All vulnerability patterns scanned
- Findings prioritized by severity
- Attack plan for next phase established
- Defensive recommendations prepared

## Next Step
→ X03-CONTRACT-ASSAULT.md
